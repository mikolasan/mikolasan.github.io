{"componentChunkName":"component---src-templates-blog-template-js","path":"/ai/hopfield-networks","result":{"data":{"markdownRemark":{"html":"<p>It probably started in <a href=\"https://www.pnas.org/doi/10.1073/pnas.79.8.2554\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">1982</a>. <a href=\"http://www.scholarpedia.org/article/Hopfield_network\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Full crash course</a> about Hopfiled networks.</p>\n<h3 id=\"train\" style=\"position:relative;\">Train<a href=\"#train\" aria-label=\"train permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">naive_train</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    M<span class=\"token punctuation\">,</span> N <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>shape\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"data shape\"</span><span class=\"token punctuation\">,</span> M<span class=\"token punctuation\">,</span> N<span class=\"token punctuation\">)</span>\n    \n    W <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">,</span> M<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    rho <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> t <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span>N <span class=\"token operator\">*</span> M<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        t <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> rho\n        W <span class=\"token operator\">+=</span> np<span class=\"token punctuation\">.</span>outer<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">)</span>\n\n    W <span class=\"token operator\">/=</span> N\n    \n    <span class=\"token comment\"># Zeroing the diagonal</span>\n    np<span class=\"token punctuation\">.</span>fill_diagonal<span class=\"token punctuation\">(</span>W<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> W</code></pre></div>\n<h3 id=\"predict\" style=\"position:relative;\">Predict<a href=\"#predict\" aria-label=\"predict permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># This function approximates the behavior of the MATLAB satlins function </span>\n<span class=\"token comment\"># (saturating linear transfer) using np.clip().</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">satlins</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> np<span class=\"token punctuation\">.</span>clip<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">predict</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    CY <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    M<span class=\"token punctuation\">,</span> N <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>shape\n    <span class=\"token comment\"># Iterating over each column of t</span>\n    <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        u <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">while</span> np<span class=\"token punctuation\">.</span>linalg<span class=\"token punctuation\">.</span>norm<span class=\"token punctuation\">(</span>satlins<span class=\"token punctuation\">(</span>W @ u<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> u<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            u <span class=\"token operator\">=</span> satlins<span class=\"token punctuation\">(</span>W @ u<span class=\"token punctuation\">)</span>\n        CY<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">)</span>\n\n    CY <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>CY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>T  <span class=\"token comment\"># Convert list of arrays to 2D array</span>\n    <span class=\"token keyword\">return</span> CY</code></pre></div>\n<p>Full notebook on <a href=\"https://github.com/mikolasan/ai_sandbox/blob/master/arc/hopfield.ipynb\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">AI sandbox</a></p>\n<h3 id=\"more-resources\" style=\"position:relative;\">More resources<a href=\"#more-resources\" aria-label=\"more resources permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<ul>\n<li><a href=\"https://www.alexbod.com/hopfield-neural-network/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">An example</a> with rotation and C code</li>\n<li><a href=\"https://github.com/ccd97/hello_nn/blob/master/Hopfield-Network/np_hnn_reconstruction.ipynb\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Nice little letters</a> and denoising that works!</li>\n<li><a href=\"https://gist.github.com/mikolasan/5f40cbea6db57bedc96c8bb6762c9ab0\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">My matlab code</a> which is absolutely unreadable (brrr)</li>\n</ul>\n<h2 id=\"modern-hopfield\" style=\"position:relative;\">Modern Hopfield<a href=\"#modern-hopfield\" aria-label=\"modern hopfield permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>And a recent article <a href=\"https://arxiv.org/abs/2008.02217\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Hopfield Networks is All You Need</a> saying that Hopfield networks just a generalization of Transformers.</p>\n<h2 id=\"biology-behind-it-\" style=\"position:relative;\">Biology behind it (?)<a href=\"#biology-behind-it-\" aria-label=\"biology behind it  permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p><a href=\"https://molecularbrain.biomedcentral.com/articles/10.1186/1756-6606-5-14\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://molecularbrain.biomedcentral.com/articles/10.1186/1756-6606-5-14</a></p>\n<p>My dictionary:</p>\n<ul>\n<li>transcription factors SRF, c-fos, EGR-1, NF-kB</li>\n<li>binding of transcritption factors</li>\n<li>control region of a gene</li>\n<li>response elements</li>\n<li>increasing the transcription</li>\n<li>binding protein</li>\n<li>phosphorylated by PKA, MAPK, CaMK</li>\n<li>promoter</li>\n</ul>","excerpt":"It probably started in 1982. Full crash course about Hopfiled networks. Train Predict Full notebook on AI sandbox More resources An example…","tableOfContents":"<ul>\n<li>\n<ul>\n<li><a href=\"#train\">Train</a></li>\n<li><a href=\"#predict\">Predict</a></li>\n<li><a href=\"#more-resources\">More resources</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#modern-hopfield\">Modern Hopfield</a></p>\n</li>\n<li>\n<p><a href=\"#biology-behind-it-\">Biology behind it (?)</a></p>\n</li>\n</ul>","fields":{"socialcard":"gatsby-plugin-social-card/3b572954-08ca-5093-80f2-7893c124ff94.jpg"},"frontmatter":{"date":"August 17, 2022","published":"August 22, 2022","lastModified":"October 20, 2022","title":"Hopfield Networks","subtitle":null,"section":null,"draft":null,"developing":null,"buttonText":null,"buttonLink":null,"secondButtonText":null,"secondButtonLink":null,"featuredImage":null}}},"pageContext":{"showLikes":true,"absolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/hopfield-networks.md","url":"/ai/hopfield-networks","next":{"excerpt":"First, a quick overview of current branches in machine learning (by Oleksii Trekhleb)  Biological neuron and mathematical models I started…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/computational-neuroscience.md","frontmatter":{"title":"Computational neuroscience","date":"2022-08-28T00:00:00.000Z","topic":null,"article":"main"},"id":"5a940991-7598-5841-8e1f-95491aa3e8fa"},"previous":{"excerpt":"Intuitively, intelligence and consciousness seem to be highly correlated. The smartest animals we know of are also the ones that show the…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/multi-agent-systems.md","frontmatter":{"title":"Multi agent systems","date":"2022-07-16T00:00:00.000Z","topic":true,"article":null},"id":"056a3599-9664-57fa-ad82-82344f1bc84c"},"recentArticles":[{"excerpt":"BAM can link together data of different types. Associations...  From one side the model requires to use bipolar patterns - arrays of -1 and…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/bidirectional-associative-memories.md","frontmatter":{"title":"Bidirectional Associative Memories","date":null,"topic":true,"article":null},"id":"3ae9ac87-4c8b-5f18-8f19-ee1091111f95"},{"excerpt":"Phenotypic variation of transcriptomic cell types in mouse motor cortex (paper). Scientist got neurons from different layers and regions and…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/brain-map.md","frontmatter":{"title":"Brain map","date":null,"topic":true,"article":null},"id":"f4152a9b-6747-5178-aea3-0de2e3f70b04"},{"excerpt":"Neural networks with biologically plausible accounts of neurogenesis they start with a minimal topology (just input and output unit) and…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/cascade-correlation-neural-networks.md","frontmatter":{"title":"Cascade Correlation Neural Networks","date":null,"topic":true,"article":null},"id":"1ba88be8-cdba-50c0-a9ba-c4a082ef60e7"},{"excerpt":"ACT-R CLARION LIDA Soar (code)","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/cognitive-architecture.md","frontmatter":{"title":"Cognitive Architecture","date":null,"topic":true,"article":null},"id":"1acc6cfc-d238-53b6-aeed-1207dd3b1d89"},{"excerpt":"Main paper PDF stacking lstms https://stats.stackexchange.com/questions/163304/what-are-the-advantages-of-stacking-multiple-lstms intro to…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/long-short-term-memory.md","frontmatter":{"title":"Long Short-Term Memory","date":null,"topic":true,"article":null},"id":"a677bfb4-f49d-559c-8957-86db6eb41bda"}]}},"staticQueryHashes":["2961657013","447685113"],"slicesMap":{}}