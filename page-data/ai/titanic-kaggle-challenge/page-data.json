{"componentChunkName":"component---src-templates-blog-template-js","path":"/ai/titanic-kaggle-challenge","result":{"data":{"markdownRemark":{"html":"<p>I always return back to <a href=\"https://www.kaggle.com/c/titanic/overview\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">this challenge</a>.</p>\n<p>First I want to look at the correlation between columns</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">make_plot</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> corr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tfig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\tax <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_subplot<span class=\"token punctuation\">(</span><span class=\"token number\">111</span><span class=\"token punctuation\">)</span>\n\tcax <span class=\"token operator\">=</span> ax<span class=\"token punctuation\">.</span>matshow<span class=\"token punctuation\">(</span>corr<span class=\"token punctuation\">,</span>cmap<span class=\"token operator\">=</span><span class=\"token string\">'coolwarm'</span><span class=\"token punctuation\">,</span> vmin<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> vmax<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\tfig<span class=\"token punctuation\">.</span>colorbar<span class=\"token punctuation\">(</span>cax<span class=\"token punctuation\">)</span>\n\tticks <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\tax<span class=\"token punctuation\">.</span>set_xticks<span class=\"token punctuation\">(</span>ticks<span class=\"token punctuation\">)</span>\n\tplt<span class=\"token punctuation\">.</span>xticks<span class=\"token punctuation\">(</span>rotation<span class=\"token operator\">=</span><span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n\tax<span class=\"token punctuation\">.</span>set_yticks<span class=\"token punctuation\">(</span>ticks<span class=\"token punctuation\">)</span>\n\tax<span class=\"token punctuation\">.</span>set_xticklabels<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span>\n\tax<span class=\"token punctuation\">.</span>set_yticklabels<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span>\n\tplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'train.csv'</span><span class=\"token punctuation\">,</span> index_col<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Sex\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">\"Sex\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"male\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"female\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Embarked\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">\"Embarked\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"S\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"C\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Q\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Cabin\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">\"Cabin\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">.</span>extract<span class=\"token punctuation\">(</span><span class=\"token string\">r'([A-Z])'</span><span class=\"token punctuation\">)</span>\n\nlevels <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>level<span class=\"token punctuation\">:</span> idx <span class=\"token keyword\">for</span> idx<span class=\"token punctuation\">,</span> level <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">sorted</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">\"Cabin\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>dropna<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>unique<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Cabin\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">\"Cabin\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>levels<span class=\"token punctuation\">)</span>\n\ndf <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>select_dtypes<span class=\"token punctuation\">(</span>include<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>np<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>dtypes<span class=\"token punctuation\">.</span>to_frame<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"Type\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># tah-dah!</span>\ncorr <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>corr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nmake_plot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> corr<span class=\"token punctuation\">)</span>\n\ndf<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"titanic_data.csv\"</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Related: <a href=\"https://stats.stackexchange.com/questions/664709/is-it-always-valid-to-use-correlation-for-feature-selection\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Is it always valid to use correlation for feature selection?</a> (answer: no)</p>","excerpt":"I always return back to this challenge. First I want to look at the correlation between columns Related: Is it always valid to use…","tableOfContents":"","fields":{"socialcard":"gatsby-plugin-social-card/aae8ea55-6c30-57eb-b327-abc2ca7c65ea.jpg"},"frontmatter":{"date":"March 25, 2025","published":"March 25, 2025","lastModified":"March 25, 2025","title":"Titanic","subtitle":"Kaggle challenge","section":null,"draft":null,"developing":null,"buttonText":null,"buttonLink":null,"secondButtonText":null,"secondButtonLink":null,"featuredImage":null}}},"pageContext":{"showLikes":true,"absolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/titanic-kaggle-challenge.md","url":"/ai/titanic-kaggle-challenge","next":{"excerpt":"I need to mix a new neural network architecture for image recognition. If we consider a simple input images, 8x8 pixels in size, where one…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/spiking-autoencoder-with-embodied-actions.md","frontmatter":{"title":"Spiking autoencoder with embodied actions","date":"2025-05-14T00:00:00.000Z","topic":null,"article":"main"},"id":"382b4b0d-346b-5e0e-b45a-ecb61bd16e92"},"previous":{"excerpt":"Negative lessons are very important. And they supposed to be stored very specifically in its own categories. These categories will provide…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/negative-training.md","frontmatter":{"title":"Negative training","date":"2024-12-07T00:00:00.000Z","topic":true,"article":null},"id":"8bdcd2d5-dd95-5f5b-b1d6-49a931e2c290"},"recentArticles":[{"excerpt":"BAM can link together data of different types. Associations...  From one side the model requires to use bipolar patterns - arrays of -1 and…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/bidirectional-associative-memories.md","frontmatter":{"title":"Bidirectional Associative Memories","date":null,"topic":true,"article":null},"id":"3ae9ac87-4c8b-5f18-8f19-ee1091111f95"},{"excerpt":"Phenotypic variation of transcriptomic cell types in mouse motor cortex (paper). Scientist got neurons from different layers and regions and…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/brain-map.md","frontmatter":{"title":"Brain map","date":null,"topic":true,"article":null},"id":"f4152a9b-6747-5178-aea3-0de2e3f70b04"},{"excerpt":"Neural networks with biologically plausible accounts of neurogenesis they start with a minimal topology (just input and output unit) and…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/cascade-correlation-neural-networks.md","frontmatter":{"title":"Cascade Correlation Neural Networks","date":null,"topic":true,"article":null},"id":"1ba88be8-cdba-50c0-a9ba-c4a082ef60e7"},{"excerpt":"ACT-R CLARION LIDA Soar (code)","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/cognitive-architecture.md","frontmatter":{"title":"Cognitive Architecture","date":null,"topic":true,"article":null},"id":"1acc6cfc-d238-53b6-aeed-1207dd3b1d89"},{"excerpt":"Main paper PDF stacking lstms https://stats.stackexchange.com/questions/163304/what-are-the-advantages-of-stacking-multiple-lstms intro to…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/ai/long-short-term-memory.md","frontmatter":{"title":"Long Short-Term Memory","date":null,"topic":true,"article":null},"id":"a677bfb4-f49d-559c-8957-86db6eb41bda"}]}},"staticQueryHashes":["2961657013","447685113"],"slicesMap":{}}