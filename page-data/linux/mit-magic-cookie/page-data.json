{"componentChunkName":"component---src-templates-blog-template-js","path":"/linux/mit-magic-cookie","result":{"data":{"markdownRemark":{"html":"<p>How to fix invalid magic cookie</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Invalid MIT-MAGIC-COOKIE-1 keyInvalid MIT-MAGIC-COOKIE-1</code></pre></div>\n<p>You need a proper content in <strong>.Xautority</strong> because Xorg started by another user (it probably could be fixed by the <code class=\"language-text\">xhost</code> command by allowing any user but I didn’t succeed in that quest)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token parameter variable\">-i</span>\n<span class=\"token function\">cat</span> /run/user/1001/gdm/Xauthority <span class=\"token operator\">></span> /root/.Xauthority\n<span class=\"token comment\"># or just point to already existing file of that user. we are the root - we can do it!</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">XAUTHORITY</span></span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">grep</span> <span class=\"token string\">\"^<span class=\"token variable\">${SUDO_USER}</span>:\"</span> /etc/passwd <span class=\"token operator\">|</span> <span class=\"token function\">cut</span> <span class=\"token parameter variable\">-d</span> <span class=\"token builtin class-name\">:</span> <span class=\"token parameter variable\">-f</span> <span class=\"token number\">6</span><span class=\"token variable\">)</span></span>/.Xauthority\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">DISPLAY</span></span><span class=\"token operator\">=</span>:0.0\n\n<span class=\"token comment\"># test</span>\nxinput <span class=\"token parameter variable\">--list</span></code></pre></div>\n<p>But this has a side effect on a GDM session. It kicks back to the login greeter (gnome-shell) from already working <strong>bspwm</strong> window manager.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo nano /etc/systemd/system/xorg-nik.service\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">Unit</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">Description</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">X11 session for nik</span>\n<span class=\"token key attr-name\">After</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">graphical.target systemd-user-sessions.service</span>\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">Service</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">User</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">nik</span>\n<span class=\"token key attr-name\">WorkingDirectory</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">~</span>\n\n<span class=\"token key attr-name\">PAMName</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">login</span>\n<span class=\"token key attr-name\">Environment</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">XDG_SESSION_TYPE=x11</span>\n<span class=\"token key attr-name\">TTYPath</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">/dev/tty8</span>\n<span class=\"token key attr-name\">StandardInput</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">tty</span>\n<span class=\"token key attr-name\">UnsetEnvironment</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">TERM</span>\n\n<span class=\"token key attr-name\">UtmpIdentifier</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">tty8</span>\n<span class=\"token key attr-name\">UtmpMode</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">user</span>\n\n<span class=\"token key attr-name\">StandardOutput</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">journal</span>\n<span class=\"token key attr-name\">ExecStart</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">/usr/bin/startx -- vt8 -nolisten tcp -background none -noreset -keeptty -novtswitch -verbose 3 -logfile /dev/null</span>\n<span class=\"token key attr-name\">Restart</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">always</span>\n<span class=\"token key attr-name\">RestartSec</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">3</span>\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">Install</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">WantedBy</span><span class=\"token punctuation\">=</span><span class=\"token value attr-value\">graphical.target</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo systemctl stop gdm\nsudo systemctl stop gdm3 \nsudo systemctl disable gdm\nsudo systemctl disable gdm3\n\nsudo systemctl start xorg-nik.service\nsudo systemctl enable xorg-nik.service</code></pre></div>\n<p>Ref: <a href=\"https://vincent.bernat.ch/en/blog/2021-startx-systemd\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://vincent.bernat.ch/en/blog/2021-startx-systemd</a></p>\n<p>Then change terminal to urxvt because gnome-terminal is broken now. <a href=\"https://addy-dclxvi.github.io/post/configuring-urxvt/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Add configuration</a>. <a href=\"https://superuser.com/questions/1491535/rxvt-terminal-emulator-resets-settings-after-logout\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Set executable flag</a> for Xresources (maybe?).</p>\n<p>But that didn’t work, I just need to load it manually in <strong>xinitrc</strong></p>","excerpt":"How to fix invalid magic cookie You need a proper content in .Xautority because Xorg started by another user (it probably could be fixed by…","tableOfContents":"","fields":{"socialcard":"gatsby-plugin-social-card/cd14c683-f8e7-56fe-bc1a-4d9464765d98.jpg"},"frontmatter":{"date":"October 18, 2024","published":"October 18, 2024","lastModified":"October 18, 2024","title":"MIT magic cookie","subtitle":null,"section":null,"draft":null,"developing":null,"buttonText":null,"buttonLink":null,"secondButtonText":null,"secondButtonLink":null,"featuredImage":null}}},"pageContext":{"showLikes":true,"absolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/mit-magic-cookie.md","url":"/linux/mit-magic-cookie","next":{"excerpt":"If one needs to serve static files evenly fast to any device in the world then they are probably thinking about CDN. Plan create S3 bucket…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/cdn-on-aws.md","frontmatter":{"title":"CDN on AWS","date":"2024-10-23T00:00:00.000Z","topic":null,"article":null},"id":"0bc398d7-2e4c-5bcf-8b18-cd002d918d22"},"previous":{"excerpt":"You have tasks defined in a file (note: check crontab-guru for easy crontab syntax editing, verifying, and maybe understanding) And manually…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/ansible.md","frontmatter":{"title":"Ansible grimoire","date":"2024-09-26T00:00:00.000Z","topic":null,"article":null},"id":"a613f847-24aa-5765-b641-b444133f7a87"},"recentArticles":[{"excerpt":"The time is now. So you are following the official path","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/lunar-vim.md","frontmatter":{"title":"Lunar Vim","date":"2025-07-12T00:00:00.000Z","topic":null,"article":null},"id":"96fd1359-d24f-593f-bfd5-c6ea877b7e1e"},{"excerpt":"Prologue When I changed my email with Asana, the service that I liked so much, I found it when I had trouble planning my day, forgiving…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/task-management-with-taskwarrior.md","frontmatter":{"title":"Task management with taskwarrior","date":"2025-06-19T00:00:00.000Z","topic":null,"article":null},"id":"d251091d-7777-5f57-a398-6317d95233da"},{"excerpt":"I called my pool 'dinosaur' and three datasets, you guessed it, triassic, jurassic, cretaceous Steps: Reference archwiki - zfs zfs handbook…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/encrypted-backup-with-zfs.md","frontmatter":{"title":"Encrypted backup with ZFS","date":"2025-06-10T00:00:00.000Z","topic":null,"article":null},"id":"a8cfe7c2-1870-5a4d-a4b6-a9e5cb56f73b"},{"excerpt":"I already got used to auto-starting services when they run with docker compose or docker stack, but I like it even more when the apps run…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/autostart-everything.md","frontmatter":{"title":"Autostart everything","date":"2025-05-26T00:00:00.000Z","topic":null,"article":null},"id":"7c1cd1ea-fc7f-558a-9576-5f5420866bad"},{"excerpt":"So this happened when I was working on a Go project and quite frequently compiled binaries for deployment in docker containers. I didn't pay…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/clear-space.md","frontmatter":{"title":"Clear space on Linux","date":"2025-04-15T00:00:00.000Z","topic":null,"article":null},"id":"b3347ef2-f534-5c29-bc5e-0ed82ca4c7ee"}]}},"staticQueryHashes":["2961657013","447685113"],"slicesMap":{}}