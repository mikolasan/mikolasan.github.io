{"componentChunkName":"component---src-templates-blog-template-js","path":"/linux/local-music-server-on-raspberry","result":{"data":{"markdownRemark":{"html":"<p>I guess you can install raspberry jukebox and do not worry about conflicting dependencies and a pile of configuration. But if you want to build the system that works for your special case then you have to reserve a few days of struggle. But then you will be proud of yourself. Maybe it will be another OS distribution for Raspberry!</p>\n<p>Note: I will be using <code class=\"language-text\">192.168.0.130</code> here - IP address of my Raspberry Pi. Do not forget to update it for your configuration.</p>\n<h2 id=\"mopidy\" style=\"position:relative;\">Mopidy<a href=\"#mopidy\" aria-label=\"mopidy permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>I think a good plan will be to install Mopidy, connect to YouTube, read my playlists there, cache music to local storage (only music, no video). Then we will need several extensions</p>\n<ul>\n<li><a href=\"\">mpd</a> for ... what? I forgot.</li>\n<li><a href=\"https://mopidy.com/ext/youtube/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">youtube</a> (DO NOT read docs from the <a href=\"https://github.com/natumbri/mopidy-youtube\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">develop branch</a> because they might have changes in the config).</li>\n<li><a href=\"https://mopidy.com/ext/ytmusic/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">ytmusic</a> and <a href=\"https://ytmusicapi.readthedocs.io/en/stable/setup/browser.html\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">search for cookie</a></li>\n<li>Also I have some tracks on Yandex Music. <a href=\"https://pypi.org/project/mopidy-yamusic/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">yamusic</a></li>\n</ul>\n<p>Frontends to choose</p>\n<ul>\n<li><a href=\"https://mopidy.com/ext/iris/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">iris</a></li>\n<li><a href=\"https://fatg3erman.github.io/RompR/Rompr-And-Mopidy\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Romp–Ø</a></li>\n</ul>\n<h3 id=\"install\" style=\"position:relative;\">Install<a href=\"#install\" aria-label=\"install permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /etc/apt/keyrings\n<span class=\"token function\">sudo</span> <span class=\"token function\">wget</span> <span class=\"token parameter variable\">-q</span> <span class=\"token parameter variable\">-O</span> /etc/apt/keyrings/mopidy-archive-keyring.gpg https://apt.mopidy.com/mopidy.gpg\n<span class=\"token function\">sudo</span> <span class=\"token function\">wget</span> <span class=\"token parameter variable\">-q</span> <span class=\"token parameter variable\">-O</span> /etc/apt/sources.list.d/mopidy.list https://apt.mopidy.com/bullseye.list\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> <span class=\"token punctuation\">\\</span>\n  alsa-utils <span class=\"token punctuation\">\\</span>\n  mpd <span class=\"token punctuation\">\\</span>\n  mopidy <span class=\"token punctuation\">\\</span>\n  mopidy-mpd <span class=\"token punctuation\">\\</span>\n  flac <span class=\"token punctuation\">\\</span>\n  gstreamer1.0-plugins-bad\n\n<span class=\"token function\">wget</span> https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp_linux_aarch64\n<span class=\"token function\">chmod</span> +x yt-dlp_linux_aarch64\n<span class=\"token function\">sudo</span> <span class=\"token function\">mv</span> yt-dlp_linux_aarch64 /usr/local/bin/yt-dlp\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> python3-websockets\n<span class=\"token function\">sudo</span> python3 <span class=\"token parameter variable\">-m</span> pip <span class=\"token function\">install</span> --break-system-packages Mopidy-YTMusic\n<span class=\"token function\">sudo</span> python3 <span class=\"token parameter variable\">-m</span> pip <span class=\"token function\">install</span> --break-system-packages Mopidy-YouTube\n<span class=\"token function\">sudo</span> python3 <span class=\"token parameter variable\">-m</span> pip <span class=\"token function\">install</span> --break-system-packages <span class=\"token assign-left variable\">ytmusicapi</span><span class=\"token operator\">==</span><span class=\"token number\">0.25</span>.2\n/home/nikolay/.local/bin/ytmusicapi browser\n<span class=\"token function\">sudo</span> python3 <span class=\"token parameter variable\">-m</span> pip <span class=\"token function\">install</span> --break-system-packages Mopidy-Iris\npip list <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mopidy\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/mpd.conf\n<span class=\"token function\">sudo</span> mopidyctl config <span class=\"token comment\"># check default config</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/mopidy/mopidy.conf\n<span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /lib/systemd/system/mopidy.service\n<span class=\"token function\">sudo</span> systemctl daemon-reload\n<span class=\"token function\">sudo</span> systemctl restart mopidy</code></pre></div>\n<p><strong>/etc/mpd.conf</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">music_directory         \"/home/nikolay/Music\"\nconnection_timeout     \"120\"</code></pre></div>\n<p><strong>/etc/mopidy/mopidy.conf</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[audio]\n#output = lamemp3enc ! shout2send async=false mount=mopidy ip=127.0.0.1 port=8000 password=hackme\noutput = audioresample ! audioconvert ! audio/x-raw,rate=48000,channels=2,format=S16LE ! filesink location=/tmp/snapfifo\n\n[mpd]\nenabled = true\nhostname = 0.0.0.0\nport = 6600\nmax_connections = 30\nconnection_timeout = 120\n\n[http]\nenabled = true\nhostname = 0.0.0.0\nport = 6680\ncsrf_protection = false\n\n[youtube]\nenabled = true\nallow_cache = true\nyoutube_dl_package = yt_dlp\nchannel_id = UCKWaOgMnVIqwNcXXuRANo6w\nmusicapi_enabled = true\nmusicapi_cookie = &lt;&lt;&lt; Read instruction where to get this >>>\n#musicapi_browser_authentication_file = /home/nikolay/browser.json\nplaylist_max_videos = 2000</code></pre></div>\n<h3 id=\"rompr\" style=\"position:relative;\">RompR<a href=\"#rompr\" aria-label=\"rompr permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> <span class=\"token punctuation\">\\</span>\n  nginx <span class=\"token punctuation\">\\</span>\n  php-curl php-json php-xml php-mbstring php-sqlite3 php-gd php-fpm php-intl <span class=\"token punctuation\">\\</span>\n  imagemagick\n<span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/php/8.2/fpm/php.ini <span class=\"token comment\"># see the content in the next blocks</span>\n<span class=\"token function\">sudo</span> systemctl restart php8.2-fpm.service\n\n<span class=\"token function\">wget</span> https://github.com/fatg3erman/RompR/releases/download/2.14/rompr-2.14.zip\n<span class=\"token function\">unzip</span> rompr-2.14.zip\n<span class=\"token builtin class-name\">cd</span> rompr/\n<span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> prefs albumart\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> www-data:www-data prefs/\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> www-data:www-data albumart/\n<span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span>/\n<span class=\"token function\">sudo</span> <span class=\"token function\">mv</span> rompr /var/www/\n<span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/nginx/sites-available/rompr <span class=\"token comment\"># see the content in the next blocks</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> /etc/nginx/sites-available/rompr /etc/nginx/sites-enabled/rompr\n<span class=\"token function\">sudo</span> systemctl restart nginx</code></pre></div>\n<p><strong>/etc/php/8.2/fpm/php.ini</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"></code></pre></div>\n<p><strong>/etc/nginx/sites-available/rompr</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">server {\n    listen 80;\n    listen [::]:80;\n\n    root /var/www/rompr;\n    index index.php index.html index.htm;\n\n    server_name raspberrypi;\n\n    client_max_body_size 256M;\n\n    # This section can be copied into an existing default setup\n    location / {\n        allow all;\n        index index.php;\n        location ~ \\.php {\n                try_files $uri index.php =404;\n\n                # This line for Debian / Ubuntu\n                fastcgi_pass unix:/run/php/php-fpm.sock;\n\n                fastcgi_index index.php;\n                fastcgi_param SCRIPT_FILENAME $request_filename;\n                include /etc/nginx/fastcgi_params;\n                fastcgi_read_timeout 1800;\n        }\n\n        error_page 404 = /rompr/404.php;\n        try_files $uri $uri/ =404;\n        location ~ /albumart/* {\n                expires -1s;\n\n        }\n    }\n}</code></pre></div>\n<h3 id=\"iris\" style=\"position:relative;\">Iris<a href=\"#iris\" aria-label=\"iris permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>Go to <a href=\"http://192.168.0.130:6680/iris\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">http://192.168.0.130:6680/iris</a></p>\n<h2 id=\"save-playlists\" style=\"position:relative;\">Save playlists<a href=\"#save-playlists\" aria-label=\"save playlists permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<h3 id=\"with-yt-dlp\" style=\"position:relative;\">With yt-dlp<a href=\"#with-yt-dlp\" aria-label=\"with yt dlp permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>Mostly everything explained in <a href=\"https://github.com/yt-dlp/yt-dlp?tab=readme-ov-file#format-selection-examples\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">the docs</a>.</p>\n<p>To transfer your cookie to Raspberry Pi use <a href=\"https://addons.mozilla.org/en-US/firefox/addon/cookies-txt/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">this extension</a>.</p>\n<p>And this is well crafted a complete command to download one private playlist:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yt-dlp <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-P</span> /home/nikolay/Music <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-o</span> <span class=\"token string\">\"%(playlist_index)s_%(title)s.%(ext)s\"</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--cookies</span> /home/nikolay/cookies.txt <span class=\"token punctuation\">\\</span>\n--ffmpeg-location <span class=\"token string\">\"/usr/bin/\"</span> <span class=\"token punctuation\">\\</span>\n--extract-audio <span class=\"token punctuation\">\\</span>\n--write-thumbnail <span class=\"token punctuation\">\\</span>\n--restrict-filenames <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--newline</span> <span class=\"token punctuation\">\\</span>\n--audio-format flac <span class=\"token punctuation\">\\</span>\n--audio-quality <span class=\"token number\">0</span> <span class=\"token punctuation\">\\</span>\n--embed-thumbnail <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--format</span> bestvideo*+bestaudio/best <span class=\"token punctuation\">\\</span>\nhttps://music.youtube.com/playlist?list<span class=\"token operator\">=</span>PL8PzFN20ieZF8Q_-PuQSeiaXBjEqrtpTV</code></pre></div>\n<h3 id=\"in-rompr\" style=\"position:relative;\">In RompR<a href=\"#in-rompr\" aria-label=\"in rompr permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>The <code class=\"language-text\">youtube</code> extension allows to send YouTube playlist to Mopidy. Just go to <a href=\"http://192.168.0.130:6680/youtube/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">http://192.168.0.130:6680/youtube/</a> and insert your playlist like <code class=\"language-text\">https://music.youtube.com/playlist?list=PL8PzFN20ieZF8Q_-PuQSeiaXBjEqrtpTV</code> and press <strong>Submit Query</strong>.</p>\n<p>Then open Rompr, the playlist from YouTube should be in the right column. Above the list find \"Save playlist\" button - this way you can restore/reload your playlist into the list of playing tracks.</p>\n<p>But what we need now is to press on three lines after any track in that playlist and select \"Add Album to Music collection\" which will actually add all tracks from the list to the collection, so do not worry about albums.</p>\n<p>Now on the left top bar the second button must be the Music Collection. Again by pressing on three lines after any track will open a dropdown that can be applied to all tracks, select \"Download All YouTube Tracks\".</p>\n<h3 id=\"from-yandex\" style=\"position:relative;\">From Yandex<a href=\"#from-yandex\" aria-label=\"from yandex permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>I found that the best way will be <a href=\"https://github.com/llistochek/yandex-music-downloader\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">a standalone tool</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">conda create --name music\nconda activate music\nconda install pip\npip install https://github.com/llistochek/yandex-music-downloader/archive/main.zip\nyandex-music-downloader --help</code></pre></div>\n<p>There are some <a href=\"https://github.com/MarshalX/yandex-music-api/discussions/513\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">tricks how to get a token</a>, but once you get that use it like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yandex-music-downloader --token \"&lt;token>\" --quality 1 --delay 3 --url https://music.yandex.ru/users/&lt;user>/playlists/&lt;playlist_id></code></pre></div>\n<h2 id=\"snapcast\" style=\"position:relative;\">Snapcast<a href=\"#snapcast\" aria-label=\"snapcast permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>Now it's time to play our collection. We are not going to play music on Raspberry Pi (which is possible through the audio jack or HDMI) but instead we will be playing <em>from</em> Raspberry Pi by streaming in home network.</p>\n<p>Seems like <a href=\"https://docs.mopidy.com/latest/icecast/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Icecast</a> doesn't work, so we will use Snapcast. For Mopidy you just need to change one line (<a href=\"https://github.com/badaix/snapcast/blob/develop/doc/player_setup.md#mopidy\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">docs</a>)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> snapserver\n<span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/snapserver.conf\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> <span class=\"token parameter variable\">-R</span> mopidy /tmp/snapfifo <span class=\"token comment\"># or sudo sysctl fs.protected_fifos=0 ???</span></code></pre></div>\n<p><strong>/etc/snapserver.conf</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">http</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">doc_root</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">/usr/share/snapserver/dist</span>\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">stream</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">source</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">pipe:///tmp/snapfifo?name=default</span></code></pre></div>\n<h3 id=\"web-client\" style=\"position:relative;\">Web client<a href=\"#web-client\" aria-label=\"web client permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>Probably super simple official web client <a href=\"https://github.com/badaix/snapweb\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">snapweb</a> but you will need some heavy tools in order to make it</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh <span class=\"token operator\">|</span> <span class=\"token function\">bash</span>\nnvm <span class=\"token function\">install</span> <span class=\"token number\">21</span>\n\n<span class=\"token function\">wget</span> https://github.com/badaix/snapweb/archive/refs/tags/v0.7.0.tar.gz\n<span class=\"token function\">tar</span> xf v0.7.0.tar.gz\n<span class=\"token builtin class-name\">cd</span> snapweb-0.7.0/\n\n<span class=\"token function\">npm</span> ci\n<span class=\"token function\">npm</span> run build\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">mv</span> dist/ /usr/share/snapserver/</code></pre></div>\n<p>Now we are almost ready!</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl restart snapserver\n<span class=\"token function\">sudo</span> systemctl restart mopidy\n<span class=\"token function\">sudo</span> journalctl <span class=\"token parameter variable\">-u</span> mopidy <span class=\"token parameter variable\">-f</span></code></pre></div>\n<p>Go to <a href=\"http://192.168.0.130/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">http://192.168.0.130/</a> and press play (it starts streaming but no sound)!\nThen go to <a href=\"http://192.168.0.130:1780/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">http://192.168.0.130:1780/</a> and press play (it starts playing the stream from this tab)!</p>\n<h2 id=\"reference\" style=\"position:relative;\">Reference<a href=\"#reference\" aria-label=\"reference permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<ul>\n<li><a href=\"https://ideatrash.net/2020/06/weekend-project-whole-house-and-streaming-audio-for-free-with-mpd.html\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">a guide</a></li>\n<li>other <a href=\"https://www.reddit.com/r/selfhosted/comments/hiy7gs/guide_to_using_mpd_for_whole_house_audio_and/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">recommendations on how to use AIMP</a></li>\n</ul>\n<h2 id=\"more-music-stuff\" style=\"position:relative;\">More music stuff<a href=\"#more-music-stuff\" aria-label=\"more music stuff permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<ul>\n<li><a href=\"https://github.com/uriel1998/mpdq\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">smart shuffle</a></li>\n<li><a href=\"https://www.musicpd.org/clients/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">mpd clients</a></li>\n<li><a href=\"https://docs.funkwhale.audio/user/index.html#set-up-your-funkwhale-account\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">fediverse</a></li>\n<li><a href=\"https://github.com/jeffvli/feishin\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">self-hosted ? music player</a></li>\n</ul>","excerpt":"I guess you can install raspberry jukebox and do not worry about conflicting dependencies and a pile of configuration. But if you want to‚Ä¶","tableOfContents":"<ul>\n<li>\n<p><a href=\"#mopidy\">Mopidy</a></p>\n<ul>\n<li><a href=\"#install\">Install</a></li>\n<li><a href=\"#rompr\">RompR</a></li>\n<li><a href=\"#iris\">Iris</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#save-playlists\">Save playlists</a></p>\n<ul>\n<li><a href=\"#with-yt-dlp\">With yt-dlp</a></li>\n<li><a href=\"#in-rompr\">In RompR</a></li>\n<li><a href=\"#from-yandex\">From Yandex</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#snapcast\">Snapcast</a></p>\n<ul>\n<li><a href=\"#web-client\">Web client</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n<li>\n<p><a href=\"#more-music-stuff\">More music stuff</a></p>\n</li>\n</ul>","fields":{"socialcard":"gatsby-plugin-social-card/ce30f8a1-a416-51ed-a054-3324185f0508.jpg"},"frontmatter":{"date":"April 12, 2024","published":"April 12, 2024","lastModified":"April 12, 2024","title":"Local music server","subtitle":"on Raspberry Pi and Debian Bookworm","section":null,"draft":null,"developing":null,"buttonText":null,"buttonLink":null,"secondButtonText":null,"secondButtonLink":null,"featuredImage":null}}},"pageContext":{"showLikes":true,"absolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/local-music-server-on-raspberry.md","url":"/linux/local-music-server-on-raspberry","next":{"excerpt":"- set breakpoint  - start execution  - step over  - step into  - continue","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/gdb-cheatsheet.md","frontmatter":{"title":"Minimalistic cheatsheet for GDB","date":"2024-05-28T00:00:00.000Z","topic":null,"article":null},"id":"fb1e04b9-5c67-505b-a895-d43833108f09"},"previous":{"excerpt":"For example OpenSSL library libssl-dev Go to packages.ubuntu.com and look for download source package (link for bionic version of openssl‚Ä¶","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/how-ubuntu-package-is-compiled.md","frontmatter":{"title":"How Ubuntu package is compiled?","date":"2024-04-09T00:00:00.000Z","topic":null,"article":null},"id":"73882d70-5135-5b2e-9eba-473d77a32693"},"recentArticles":[{"excerpt":"The time is now. So you are following the official path","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/lunar-vim.md","frontmatter":{"title":"Lunar Vim","date":"2025-07-12T00:00:00.000Z","topic":null,"article":null},"id":"96fd1359-d24f-593f-bfd5-c6ea877b7e1e"},{"excerpt":"Prologue When I changed my email with Asana, the service that I liked so much, I found it when I had trouble planning my day, forgiving‚Ä¶","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/task-management-with-taskwarrior.md","frontmatter":{"title":"Task management with taskwarrior","date":"2025-06-19T00:00:00.000Z","topic":null,"article":null},"id":"d251091d-7777-5f57-a398-6317d95233da"},{"excerpt":"I called my pool 'dinosaur' and three datasets, you guessed it, triassic, jurassic, cretaceous Steps: Reference archwiki - zfs zfs handbook‚Ä¶","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/encrypted-backup-with-zfs.md","frontmatter":{"title":"Encrypted backup with ZFS","date":"2025-06-10T00:00:00.000Z","topic":null,"article":null},"id":"a8cfe7c2-1870-5a4d-a4b6-a9e5cb56f73b"},{"excerpt":"I already got used to auto-starting services when they run with docker compose or docker stack, but I like it even more when the apps run‚Ä¶","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/autostart-everything.md","frontmatter":{"title":"Autostart everything","date":"2025-05-26T00:00:00.000Z","topic":null,"article":null},"id":"7c1cd1ea-fc7f-558a-9576-5f5420866bad"},{"excerpt":"So this happened when I was working on a Go project and quite frequently compiled binaries for deployment in docker containers. I didn't pay‚Ä¶","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/linux/clear-space.md","frontmatter":{"title":"Clear space on Linux","date":"2025-04-15T00:00:00.000Z","topic":null,"article":null},"id":"b3347ef2-f534-5c29-bc5e-0ed82ca4c7ee"}]}},"staticQueryHashes":["2961657013","447685113"],"slicesMap":{}}