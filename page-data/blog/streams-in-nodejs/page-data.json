{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/streams-in-nodejs","result":{"data":{"markdownRemark":{"html":"<p>I'm trying to add \"last updated\" time to <a href=\"/blog/what-static-site-generator\">my blog on Gatsby</a>.</p>\n<h2 id=\"timeline\" style=\"position:relative;\">Timeline<a href=\"#timeline\" aria-label=\"timeline permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<ul>\n<li>Day 1. Install Gulp</li>\n<li>Day 2. Recursively get a list of files where date is needed</li>\n<li>Day 3. I don't know about streams in Nodejs. How to use <strong>through2</strong>? ðŸ¤¯</li>\n<li>Day 4. I don't want to read about <strong>through2</strong>, its API is irrational ðŸ™Š</li>\n<li>Day 5. No</li>\n<li>Day 6. Nope</li>\n<li>Day 7. Finished with the search bar</li>\n<li>Day 8. The light came, I understand how to use secrets in GitHub's actions</li>\n<li>Day 9. Updated Gatsby to 4. It broke GraphQL queries with <code class=\"language-text\">childImageSharp</code>. Fixed by undocumented feature mentioned in a comment on Gatsby's issue tracker.</li>\n<li>Day 10. Back to Gulp. I'm getting file contents ðŸ¥³. Am I following tutorials? No, I'm adopting code from other plugins ðŸ¤ </li>\n<li>Day 11. Crafted 2 <code class=\"language-text\">git log</code> commands to get date when file was initially published and last modification time. The result from child process comes in callback, so I will need to figure out how to wrap it in a <code class=\"language-text\">Promise</code> and return this thing from Gulp's task.</li>\n<li>Day 12. I wanted to report here that I was consumed by <a href=\"/blog/all-that-web3-shit\">Dapp investigation</a> and did 0 progress, but then opened my draft notes from the yesterday and did small refactoring. I still disagree with the statement:</li>\n</ul>\n<blockquote>\n<p>\"Streams are node's best and most misunderstood idea\"</p>\n</blockquote>\n<ul>\n<li>Day 13 - Day 20. No progress whatsoever.</li>\n<li>Day 21. Done. Final <a href=\"https://github.com/mikolasan/mikolasan.github.io/blob/gatsby/gulpfile.js\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">gulpfile.js</a> file</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; flex:0.815;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5a60b582a47e33d0e9f355c24a5524db/3534c/streams-in-nodejs.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 122.69938650306749%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACnklEQVR42o2UiXYaMQxF+ZeGsSVb3jXjWYCk0PZk+f/vqTxAlwTS+hjOwFj2e1eyNqdlePtx2E2DNUhkEFFrDecJcH5qD7fGhqPbT1yZ+75wDt5ZBKWhbaGV0qp9dfK5GSy7dl03G6gluZxsCC642geO1qcYUsicRy7e2rbTu2BRK7KSwWHg6VCnKRUOQ7GVfc/ZeUeOUvDi5+PpGyN/AxhHgTO3AGrB7GPPJUfxKprvym6IBBI0h2p1KE/mYvl2zF/B5Awnmhm/z/rbrB4rlLCSvqButPEWcJFt5O0h6dPihj7U0Y0T+UCZHTNy1o4UkRXzN4OFBGQHzyM+7uKySM7C02OedoIgTGMi7y1ZWfYB9hUYWZuLnxlKlmNA0JqWbUB5vVKB27IRLcoCeNiqL1v90Ont5QTQ/xoXYM7bmuGp6n2vp4IiU13hX1NwGUr/lr856zpkPO7cfnSH2cyj9R5zRu81kQpBpaS9F2zGBU+knZefWvLbKkzM9UE/j2acEtc8z3l/4H4qy+RTcpZaQs4JW4e+ZPGSKgBHZqn+OJtpCDmZELQloLU2jbWyQN3zvALDB6F1ndtutdqp87gLTDJIztpoU0ROILMkFH6yJYimT+dKW+5bpByxz2twhBiMsY3kfwVTopxQstUnKUmsBVK0RsrFQLN0Z66eCa2zycMQNUedo9BqdScH45nv3SIRdQb2ybzs7esTvh3h9Yj72UlF5xSiF/ske9wFppT0IP1ysF8nOO1gYRyL7Nnak/r0TrdgOdkabVcbxkpjwE4qG5tbWK/Er4yp9w0QzZDhNJtSh2E3lbFnmdJNx75KQ15qHkosSTqhiGkH/GFBuicKqmWQ259TjjFFHrgfOJe0Fhg5t3ZU75y0BKkIEXkN/gm4gAPGuJ1bTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"My final gulpfile\"\n        title=\"\"\n        src=\"/static/5a60b582a47e33d0e9f355c24a5524db/a6d36/streams-in-nodejs.png\"\n        srcset=\"/static/5a60b582a47e33d0e9f355c24a5524db/222b7/streams-in-nodejs.png 163w,\n/static/5a60b582a47e33d0e9f355c24a5524db/ff46a/streams-in-nodejs.png 325w,\n/static/5a60b582a47e33d0e9f355c24a5524db/a6d36/streams-in-nodejs.png 650w,\n/static/5a60b582a47e33d0e9f355c24a5524db/3534c/streams-in-nodejs.png 808w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"takeout\" style=\"position:relative;\">Takeout<a href=\"#takeout\" aria-label=\"takeout permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>Just for fun and educational purposes I tried to avoid new dependencies. I could use <strong>gulp-git</strong>, <strong>gulp-replace</strong> or <strong>gulp-inject-string</strong> modules, but instead I studied their code and used only bare minimum for my needs.</p>\n<p>I learned about <code class=\"language-text\">/d</code> flag in RegEx and a little about Transform.</p>\n<p>The turning point happened when I realized that transform inside transform is not going to work, and that <code class=\"language-text\">pipe()</code> doesn't take gulp's task as an argument. Sounds silly now, but lack of tutorials and dynamic types were telling me: why not? ðŸ‘¿</p>\n<h2 id=\"reference\" style=\"position:relative;\">Reference<a href=\"#reference\" aria-label=\"reference permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<ul>\n<li>work with streams <a href=\"https://github.com/gulpjs/gulp/blob/master/docs/writing-a-plugin/dealing-with-streams.md\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://github.com/gulpjs/gulp/blob/master/docs/writing-a-plugin/dealing-with-streams.md</a></li>\n<li>no use of through2, use Transform <a href=\"https://github.com/lazd/gulp-replace/blob/master/index.js\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://github.com/lazd/gulp-replace/blob/master/index.js</a></li>\n<li>get file content <a href=\"https://github.com/eugeneware/replacestream/blob/master/index.js\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://github.com/eugeneware/replacestream/blob/master/index.js</a></li>\n<li>good example <a href=\"https://github.com/sindresorhus/gulp-filter/blob/main/index.js\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://github.com/sindresorhus/gulp-filter/blob/main/index.js</a></li>\n<li>git: last modified time <a href=\"https://stackoverflow.com/questions/4784575/how-do-i-find-the-most-recent-git-commit-that-modified-a-file\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://stackoverflow.com/questions/4784575/how-do-i-find-the-most-recent-git-commit-that-modified-a-file</a></li>\n<li>git: first published time <a href=\"https://stackoverflow.com/questions/11533199/git-find-commit-where-file-was-added\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://stackoverflow.com/questions/11533199/git-find-commit-where-file-was-added</a></li>\n<li>git log <a href=\"https://git-scm.com/docs/git-log\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://git-scm.com/docs/git-log</a></li>\n<li>gulp git <a href=\"https://github.com/stevelacy/gulp-git/blob/master/lib/exec.js\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://github.com/stevelacy/gulp-git/blob/master/lib/exec.js</a></li>\n<li>file content manipulation <a href=\"https://github.com/mikehazell/gulp-inject-string/blob/master/index.js\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">https://github.com/mikehazell/gulp-inject-string/blob/master/index.js</a></li>\n</ul>","excerpt":"I'm trying to add \"last updated\" time to my blog on Gatsby. Timeline Day 1. Install Gulp Day 2. Recursively get a list of files where dateâ€¦","tableOfContents":"<ul>\n<li><a href=\"#timeline\">Timeline</a></li>\n<li><a href=\"#takeout\">Takeout</a></li>\n<li><a href=\"#reference\">Reference</a></li>\n</ul>","fields":{"socialcard":"gatsby-plugin-social-card/a2c71177-225c-50b0-b34a-8cc813257e47.jpg"},"frontmatter":{"date":"October 04, 2021","published":"September 08, 2022","lastModified":"September 08, 2022","title":"Streams in NodeJS","subtitle":null,"section":null,"draft":null,"developing":null,"buttonText":null,"buttonLink":null,"secondButtonText":null,"secondButtonLink":null,"featuredImage":null}}},"pageContext":{"showLikes":true,"absolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/streams-in-nodejs.md","url":"/blog/streams-in-nodejs","next":{"excerpt":"Credit: Photo by Randy Fath on Unsplash I was so happy to finish my site design improvements. I followed best practices from highly ratedâ€¦","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/how-windows-web-developers-fix-websites-in-safari.md","frontmatter":{"title":"How Windows web developers fix websites in Safari?","date":"2021-10-17T00:00:00.000Z","topic":null,"article":null},"id":"75407696-0bed-5427-aa10-dfd917c8a736"},"previous":{"excerpt":"A story about perfect class hierarchy that is easy to think of, but hard to implement. We all do it. The easiest way to understand howâ€¦","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/perfect-class-hierarchy.md","frontmatter":{"title":"Perfect class hierarchy","date":"2021-08-31T00:00:00.000Z","topic":null,"article":null},"id":"550888a9-8464-5d6c-9ae3-4b21b67b17c3"},"recentArticles":[{"excerpt":"To read AI hype is over? (post from 2023) - Lâ€™IA nâ€™est-elle quâ€™un mythe qui sâ€™essoufflera ? About Google alternative services -  Comment jâ€¦","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/learning-french.md","frontmatter":{"title":"How I am learning French","date":"2025-07-12T00:00:00.000Z","topic":null,"article":null},"id":"de46ffde-c202-594f-b222-f5f4a548fbe4"},{"excerpt":"I think I like having a dialogue with someone who knows about the topic, even with students who just obtained knowledge from canonicalâ€¦","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/lizards-and-continuous-space.md","frontmatter":{"title":"Lizards and Continuous space","date":"2025-06-23T00:00:00.000Z","topic":null,"article":null},"id":"6ee1f95a-2c05-5950-8a0d-20ff4d937fb1"},{"excerpt":"Yes, developers add new features, refactor other parts to get rid of technical debt. This often changes API, which usually triggersâ€¦","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/new-ui-and-conspiracy-in-it-industry.md","frontmatter":{"title":"New UI","date":"2025-06-21T00:00:00.000Z","topic":null,"article":null},"id":"fe2e710c-0afa-5b11-8a7d-1dc46d02f0f9"},{"excerpt":"Now when I almost finished with the titanic competition (I didnâ€™t reach 90% accuracy as I planned, although I doubt itâ€™s possible), itâ€™sâ€¦","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/regulus.md","frontmatter":{"title":"Regulus","date":"2025-05-13T00:00:00.000Z","topic":null,"article":null},"id":"cf23a6fc-e0e2-571b-9dbf-5030b3af25dd"},{"excerpt":"When I found out there was a popular platform where people share open source projects, I imagined GitHub differently. I thought I could findâ€¦","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/how-github-should-work.md","frontmatter":{"title":"How GitHub should work","date":"2025-04-03T00:00:00.000Z","topic":null,"article":null},"id":"63562cc8-f132-5cbc-a444-5639c4a78d98"}]}},"staticQueryHashes":["2961657013","447685113"],"slicesMap":{}}