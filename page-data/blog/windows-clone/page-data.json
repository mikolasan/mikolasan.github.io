{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/windows-clone","result":{"data":{"markdownRemark":{"html":"<p>What do you need to know when you clone Windows 10 from one drive to another or How I spent one week without a computer trying to upgrade SSD on my laptop.</p>\n<p>I’m a Linux guy. I feel very comfortable in a terminal and I know tools. If I don’t remember how tools work, I read man pages. I did many installations of Linux systems like Arch, Gentoo, I followed Linux From Scratch guide, I <a href=\"/blog/custom-linux\">build my own system</a> with Buildroot.</p>\n<p>So I decided to clone my Windows system from the Linux environment. In this article you will see how I continuously failed along various approaches, but didn’t give up as many people do reinstall Windows from scratch, no, I pursued my goal every evening after work throughout a week, and I made a backup. And moreover I made a backup and a virtual box image.</p>\n<p>But before I start my story here is a short recap of my new knowledge.</p>\n<p>What you need to know when you clone Windows 10 from one drive to another</p>\n<ul>\n<li>All free/shareware tools suck. But we will find a way to deal with it</li>\n<li>I tried MiniTool Partition Wizard and got corrupted filesystem (200GB of written data on my new SSD wasted)</li>\n<li>I tried AOMEI Backupper and it was analyzing disk for hours, so I cancelled it</li>\n<li>I downloaded 700MB to install Acronis from Sabrent, but only after it polluted my system with files and services, it said that it’s going to work only with Sabrent drives installed into the motherboard. Wasted time.</li>\n<li>Do not copy from live OS - chances to get corrupted file system are much higher. Possibly Windows Volume Shadow Copy service can eliminate such problems, but this approach I leave for Windows gurus.</li>\n<li>Samsung Magician cannot copy from offline OS. It can only copy from the current live Windows system, which is not good, see above why</li>\n</ul>\n<p>We recently purchased new computers with two M.2 slots on motherboards, so I had envisioned that copying 300GB from one SSD drive to another would be a blazing fast task. That’s why I start with stupid copy approach using my favorite copy tool rsync.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 482px; flex:1.3697478991596639;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aa553b41f4fdbbd366431b1d6a47af9e/37e0d/windows-clone-intel-drive-benchmark.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.00613496932516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD70lEQVR42j2U61NTVxTF7//Tr532Q6ft2HHslzKjSFVsfVREC9U6Vkf7Gm2n9W1FfBRpISJUCz5ACia5QQJpgLxAiElIIEEgCbkJuZDXBQUCvx5ixzOzZu81e+actWevfaSyQ7up2F/GocqDVB48wJflZRzcv0/k5VQe2M/uz3awvWQLpdu2FuKnxZsL2F5S/AbrfNfOHXxeuh3JYu6ls70Dc9dTumQZo95Ad5cJ2WjEJLjJYOCpSab10SN6zGYGXQ4cdhtOhx3bQD922+vc5XRiNOiR1FwSJaUQV+MsLi6S0xZIp1LkchrLyyssLAieTpOIJ8hmcwWuaTk0EdfWeF3PpMmvrhKNhJFODW7ipOUj2qLnWcwskUrPMTYeYHp6mpnoDJFwmFgshqIozIg4E40yOurD5/cTj8cZHx8TGCeTyTA1+QKpS7mBMVqNN9pOfgmhJotrcBC3x4O134rX52VlJc9qPs/Sq2Xy+TVGvaOMuL24hgaxiZZT6QzrJxqJIJ3vLeN0x16axy5RN3GMP8Nfc9a8l8M1xez8eQO1rVex9dlpe9zOg4lL3AwdoEE5zrmeL9hz5mMaHt/CaXNytfoqdocDSResoN5/iCexS7TGf+TB7DHuTR7nd+sRLsvltA3UMRNW8Hi8mJTrNCeO8FA9wZ3AN1T3VPDE1iwU+7H2WYXqEaQG+wVumc9iCrUghxsxRHXcdVRTa7xAdcdprCNmxgNBZNmEZfoxndN/IMfucM91jYtNp5D79KLVKP0DfYVHpSuBzVT5SmiZOcltZR91aimXh4v5pXczP3RvpLWvnmBggn+EtVqV09QktqKb28VvIyUc1m3gdmcVLvsQBmGZEbcbqc3ZQLOlHtuLp9giMn3hJ9jjMvqRFoyWDjHBIIGAH5/Xx2D4X6yRDmwx4VHvI9r7/8br9wpLxRkbG8MvJi9973iPb60foJuq4HqkmMuRTVQrn7Dn9luUnyribtNDGv9qRFffQNP0US5GNnBttojvLO9Teu5tGpubcA8P09JyH4cwt2T2P0R23+dZxMKzuNiEeBdOxURYcxNJBkml0qjJWZSYwnNlAJdQP5QQ3YT1DId7URIxVHWOsDD1RCiEdNTyDofld6kNVlI1tY2LU0X8OrmRydwQ+jYT3T3d1NfXcfNGDQ0vjnNmchNVsS2csH7IT7e+orZGh9Gop6rqivDlEJIno8eTNjCetTKaM+HTDHi0TlQtQno+w9ycSiKRIJlUCWUH8IraqGbEk+lkUn1OclZFnUsyPz9PKBREWtbWeJnL8zK7wqtsXmC1AC37emcXNK2wr+t4mV1+U3+VW2VxYen/3dYK/8D6hf8BxEjDx3gzLn4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Intel SSD benchmark\"\n        title=\"\"\n        src=\"/static/aa553b41f4fdbbd366431b1d6a47af9e/37e0d/windows-clone-intel-drive-benchmark.png\"\n        srcset=\"/static/aa553b41f4fdbbd366431b1d6a47af9e/222b7/windows-clone-intel-drive-benchmark.png 163w,\n/static/aa553b41f4fdbbd366431b1d6a47af9e/ff46a/windows-clone-intel-drive-benchmark.png 325w,\n/static/aa553b41f4fdbbd366431b1d6a47af9e/37e0d/windows-clone-intel-drive-benchmark.png 482w\"\n        sizes=\"(max-width: 482px) 100vw, 482px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>We have PCIe Gen 4 and Gen 3 on the motherboard, and drives support PCIe Gen 3 x4 at maximum. So I expect the copy to be up to 3000MB/s, which means that 256GB of my data should be copied in less than 2 minutes. Awesome!</p>\n<h2 id=\"attempt-1-rsync\" style=\"position:relative;\">Attempt 1: rsync<a href=\"#attempt-1-rsync\" aria-label=\"attempt 1 rsync permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<h3 id=\"plan\" style=\"position:relative;\">Plan<a href=\"#plan\" aria-label=\"plan permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>Boot into live CD. I use Manjaro installer.</p>\n<p>Open Gparted and recreate partition table and partitions on new drive in the likeness of your old system.</p>\n<p>Note: Weirdly enough Windows requires 16MB after ESP partition for its own secret deals. So check out their <a href=\"https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/configure-uefigpt-based-hard-drive-partitions?redirectedfrom=MSDN&#x26;view=windows-11\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">official docs about it</a></p>\n<p>Then format, set flags, set partition names and labels.</p>\n<p>Then mount and run rsync.</p>\n<h3 id=\"pitfalls\" style=\"position:relative;\">Pitfalls<a href=\"#pitfalls\" aria-label=\"pitfalls permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>Now, why you should never NEVER ever do this with NTFS filesystems:</p>\n<p>you will mess up Windows permissions and on boot you will get error</p>\n<ul>\n<li>Your PC needs to be repaired, Error 0xc0000225 on Windows 10</li>\n</ul>\n<p>A Required Device Isn't Connected or Can't Be Accessed</p>\n<p>Any attempt to fix it will fail. Only reinstall will help.</p>\n<p>How to diagnose it. Boot Windows system from another drive and look at your new system in File Explorer. If system and hidden folders and files look like normal then you definitely screwed permissions and your system is toast.</p>\n<p>And even if sometime in this universe ALC permissions will be added to Linux drivers, then you will need to fix Windows drive mounting letter in the registry following <a href=\"https://superuser.com/questions/1235910/cloning-windows-10-partition-to-different-drive-not-working-in-dual-boot-setup\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">these steps</a></p>\n<p>Even if we would have the ability to read and copy ACL permissions, I was not impressed by the speed of rsync. It was 80MB/s. So let’s move on to another approach.</p>\n<h2 id=\"attempt-2-dd\" style=\"position:relative;\">Attempt 2: dd<a href=\"#attempt-2-dd\" aria-label=\"attempt 2 dd permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>Apparently, after 28 years NTFS stays solely the file system for Windows and it still has minimal support on Linux. No one cares.</p>\n<p>We will be above it. Actually we will go deeper on a lower layer and will copy data byte by byte ignoring all these higher level things as partition table, file systems, journals.</p>\n<p>Using <code class=\"language-text\">dd</code> we can copy one small drive to the beginning of the big drive and then extend the last partition. You can even move partitions like I did: I moved windows recovery partition to the end and then extended system partition that goes behind it.</p>\n<p>As before we boot into live USB and <a href=\"https://superuser.com/questions/1712900/how-can-i-clone-a-windows-10-disk-onto-a-larger-disk\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">use dd</a> or <a href=\"https://unix.stackexchange.com/questions/444019/how-can-i-clone-backup-restore-windows-10-from-linux\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">cat or pv</a></p>\n<p>Everything goes faster than rsync, I get 500MB/s but then after 100GB it halts after read error. I run it again and it aborts on the same spot. Again, 200GB of written data is wasted on my new SSD.</p>\n<p>I <a href=\"https://askubuntu.com/questions/253117/how-do-i-fix-an-input-output-error-using-dd\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">googled the read error problem</a> and was thinking if I should try <a href=\"https://lifeinhex.com/tag/ddrescue/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">ddrescue</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo ddrescue /dev/sdc1 /dev/sda1 | pv</code></pre></div>\n<p>or <a href=\"https://web.archive.org/web/20130608003739/http://www.sjvs.nl/forcing-a-hard-disk-to-reallocate-bad-sectors/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">overwrite sectors with hdparm</a></p>\n<p>hdparm –write-sector 1261069669 –yes-i-know-what-i-am-doing /dev/sdb</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">hdparm --write-sector 11233976 --yes-i-know-what-i-am-doing /dev/sdb</code></pre></div>\n<p>But of course I tried another solution first: add a flag to dd to ignore any errors</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo dd if=/dev/sdc1 of=/dev/sda1 conv=noerror</code></pre></div>\n<p>You probably know the result at this point: additional 200GB of written data is wasted on my new SSD.</p>\n<h3 id=\"benchmark-ssd-readwrite-speed-with-dd\" style=\"position:relative;\">Benchmark SSD read/write speed with dd<a href=\"#benchmark-ssd-readwrite-speed-with-dd\" aria-label=\"benchmark ssd readwrite speed with dd permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>In the chapter about <code class=\"language-text\">dd</code>, it would be criminal not to mention how to measure read and write performance of HDD or SSD or NVME (M.2) drive. Because it's so simple.</p>\n<p>So <strong>read performance</strong> is measured by reading an existing file and sending it to the void <a href=\"https://www.unixtutorial.org/test-disk-speed-with-dd/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">source</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">dd if=./test of=/dev/zero bs=512k count=2048</code></pre></div>\n<p>But before that you need to disable cache optimization</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo /sbin/sysctl -w vm.drop_caches=3</code></pre></div>\n<p><strong>Write performance</strong> is similar and simpler, swap <code class=\"language-text\">if</code> and <code class=\"language-text\">of</code> and do not worry about cache:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">dd if=/dev/zero of=./test bs=512k count=2048 oflag=direct</code></pre></div>\n<h2 id=\"attempt-3-vhd\" style=\"position:relative;\">Attempt 3: VHD<a href=\"#attempt-3-vhd\" aria-label=\"attempt 3 vhd permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>At this point I started worrying that my 5 year old SSD drive is going to die any time soon and I was afraid to do any other clone experiments before I am sure that my data is safe.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; flex:0.9760479041916168;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/57dd5912b198828485e4dbb55f81080a/fdaf8/windows-clone-intel-drive-info.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 102.45398773006133%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADHElEQVR42qVUuZLTUBDUDxPzA8SQk5FQRURGQEFAwNrUetfHrvEl+dB92TosWbIsuZkZe72bLEsVqpp69ntPre6ZnlF+tG9w27lG+3aAq1Ybtzc36HW7l/jVamE4HELTVKjq7DFmM2iqKvu8LpcL3N0NoCztEI7lIMorGKaFNE1R1zWqqsKB1vpJHA4HVBQPa1mW2O12Enw/CAIocVAgT4ByV6NpaiRJgul0Cs/zsFhomM5ObNSZivl8Acs0ic0Sy8UC2+0Wx+NRgJumgWHoUPJtiiJLsS9z8MNfD8MQtmXLS9PJFI7jwPc9RFEkCpIkhr5awXVdxPSb2W/Wa8y1OZSv3RBvP7bw4ZuOMBNM5PkOvufDth0Yui5s4zimj9XChGNNAI5jyxmTCOiDGgO+70Z49XmE199dLLdHAcyynC67MC0LOgEyWwbgfX6ZZUabDSw65/2iLGSdzwkwjUnCJkaeZjg2J8CCkuySTJbKEvM8R1EUaEgag7FEBgyDUHK+o3PX9WBSfpVP/RBvvgzx7qcD68ywoZdYMjPgS7ZtY0MAMeWQ87gj8P1+L8XgqKoTa86j4iVbmGmBZZggjGKxAB8yq22WyZrlGSU/FTDOZUlgNeWxPuczo3sZ3WPZymgRIVxHcEwD4/GYSm9ebMDAHM15BQvgpTnJrqlIXDQ2/oxsJT4caBu4QUw5cMhfq4u8styLWR+CJUo8/U8fXpA32becnoDspnTUDQwnwFLTqHXuxLxhuJYiPHTHc7Hfl5hMJuj3+48Mr8cEaBMgdcV4PBEzvwQkrVedAEejEQbUw6p6BhzOI3ghS7bFc1xV3w9eBD2lYo8VdQwPBn7vIlknhivaHI/G4nb2lAyIQ/U84FkyF/L+/l5MLQw7EwK0fJjU2NPpjNj5p8pSlV9kSIUZEYkujTnOvTAcaBFcfwOHqsv0WTZXOSXfyQj7q+RKJg8PEF03Tgx/69RCUUL9atIE0cmHhuSEL3g0TXhEPZdPBjTonkYOMWmWsjqFO+F/HzE9PaxM6Vxf424wIC/1ztG/rIN/jH6vh3vycLt1hT/asuDpqcvXQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Intel SSD Drive info\"\n        title=\"\"\n        src=\"/static/57dd5912b198828485e4dbb55f81080a/a6d36/windows-clone-intel-drive-info.png\"\n        srcset=\"/static/57dd5912b198828485e4dbb55f81080a/222b7/windows-clone-intel-drive-info.png 163w,\n/static/57dd5912b198828485e4dbb55f81080a/ff46a/windows-clone-intel-drive-info.png 325w,\n/static/57dd5912b198828485e4dbb55f81080a/a6d36/windows-clone-intel-drive-info.png 650w,\n/static/57dd5912b198828485e4dbb55f81080a/fdaf8/windows-clone-intel-drive-info.png 674w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>So the priority has changed and I was looking for ways to make a backup first. From my experience, the backup that will work on Linux or Windows machine is a drive image recognized by virtual machines. Virtual Box can work with VHD and Windows has official tool for making such image - <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/disk2vhd\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Disk2vhd</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; flex:1.8314606741573034;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fff3f54ac4a359612d4f603522e8fd2f/f3c12/windows-clone-disk2vhd-past-time.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.601226993865026%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACV0lEQVR42k2RX2vTUBjG8wWErRejWG26pl3bdbWtc85Oq44hE8Qb9wGGejkmbd1g4JUIinqhXvgHRMELUfwSDtHpNplrlqztSLJ1SZqTJmlymta0vZlvp1NfHl7eczi/c3ieQyiKYho6xtj52XQcx7bt7uy02u1Wp9Npt9uNRmNvby+Xy/X29lIU5fP5SNIXpPxjxweIdZpdWllbpzeLXHmL31EUBDC2LAtjFanKfsGl2Wz2L+wlfaGA/9qlEaLEi2ssz+8iTtLKFc00TeugZFkul8uSJMHjmUzG5XIdwGRoIJhKRAhR3N0WeFkSsQWYaRg1qN99fzB0XQd4dnb2H+wlo+FQ+sQQIQjb2ztlpFZx3VbVaqPZhMdrNROYer0OMxxwWq3sf56Per3xWGwyPUZwHFcoFAubBYEXeF5ASoWmNwRBYFlGQQjyo/O0punguaenx+/3A3zY4xkMBa9fmSBKpa1KpdKNCFvFYkncFQHmOJ5hGFmGfUzn8wip8/Pzbrc7EokEAsFj8URqdPR9boqoVqsQrNWNGOuGXjNrxr5l6DDjOgbb8G+3Fub6ve70qeT54djUudSFs6npk3FCQ5qOdEPVdaTZpt2V1Wj8ka2pGpIUx3ayN2Y8fYeGh6hEmIwGPMkwmYxSxCv63cLS3TvfH99efXR/49kD5jnoXv4p6OHGi7f8h5ebb54UX1+dmT7S5woHycGQLzEUiIbIZIwifpTWv7DfWKlYkEvQQYxYWFz79Jle+souLzMrH1cXYXlzLhMO9J8Zjk+MJC6Ppy+On54cH/0F03+nsN5ElFwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Disk2vhd going for hours after estimated time\"\n        title=\"\"\n        src=\"/static/fff3f54ac4a359612d4f603522e8fd2f/a6d36/windows-clone-disk2vhd-past-time.png\"\n        srcset=\"/static/fff3f54ac4a359612d4f603522e8fd2f/222b7/windows-clone-disk2vhd-past-time.png 163w,\n/static/fff3f54ac4a359612d4f603522e8fd2f/ff46a/windows-clone-disk2vhd-past-time.png 325w,\n/static/fff3f54ac4a359612d4f603522e8fd2f/a6d36/windows-clone-disk2vhd-past-time.png 650w,\n/static/fff3f54ac4a359612d4f603522e8fd2f/f3c12/windows-clone-disk2vhd-past-time.png 764w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>So do not repeat my mistakes:</p>\n<ol>\n<li>Disable VHDX format, because it’s not supported by ANY version of Virtual Box (not 4, not 5, not 6, not any other future version).</li>\n<li>Do not copy live system or system that has read errors like I on the then with dd (how to detect such sectors is another question)</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; flex:1.8953488372093024;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d0d15b39eb8bd77b8aa1382815e1031c/61583/windows-clone-broken-vhd-image-in-virtual-box.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.760736196319016%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB8klEQVR42mO4evXqhQsXrl65euH8xcmTp8yZu2Dt6tUL5s3LSEtLT00ForSUlIL8vLLSktKS4vKyUiB77959//////HjJ8PvP3/+/vnz88+/jx8/9k2e+vTZc6DE3bv3+Pj4ONjZOcGAnYODjZ2dDcxlYGCY2F32//PxL28vMjx98uTfv/+vPry5eetGbXPH6TNnHj58uGfPHlYWVgYMwMzEBCS7m2J+PJ397u4ChncPbwCt+v37158/fzw8PNjZ2cXExPjAQFhYGF0zM0hzX2f+/x8nvr7cy7DgyP31t//de/8HaISTkxNQjoWFBUja29tHR0erqqoaGxubmJhAHAzR3NOW+e/j9o8v9jG0b7nctOXO2Qfv0TTz8/OLiIiwsrKygwET2MFQza2pf95v/PBsB8OtS2duXjjx5sXTP3//Am0Dq2BmwAEgfu5pTfv7YdOHZzsZTp85e+r02UePnnz58sXOzg6umZGREbfm1D/vNn54uoPh7Nmzp0+ffvnyJdDZrq6uQDmgI1nAgIuLS1BQgIeHh42NDSICZAAV9Lam/n6/4f0zVM0QP8OdzcTEDAFwV0B83tRY/e71vUcPrkE1v3r1Cqi5vb09IiIiMTExHgzi4uJiYmJiY2JAjNjYsKjowNBII1Nza2sbRycXBwcnAPYm+86dKKAyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Broken filesystem on cloned virtual drive\"\n        title=\"\"\n        src=\"/static/d0d15b39eb8bd77b8aa1382815e1031c/a6d36/windows-clone-broken-vhd-image-in-virtual-box.png\"\n        srcset=\"/static/d0d15b39eb8bd77b8aa1382815e1031c/222b7/windows-clone-broken-vhd-image-in-virtual-box.png 163w,\n/static/d0d15b39eb8bd77b8aa1382815e1031c/ff46a/windows-clone-broken-vhd-image-in-virtual-box.png 325w,\n/static/d0d15b39eb8bd77b8aa1382815e1031c/a6d36/windows-clone-broken-vhd-image-in-virtual-box.png 650w,\n/static/d0d15b39eb8bd77b8aa1382815e1031c/e548f/windows-clone-broken-vhd-image-in-virtual-box.png 975w,\n/static/d0d15b39eb8bd77b8aa1382815e1031c/3c492/windows-clone-broken-vhd-image-in-virtual-box.png 1300w,\n/static/d0d15b39eb8bd77b8aa1382815e1031c/61583/windows-clone-broken-vhd-image-in-virtual-box.png 1616w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"attempt-4-shareware-tools\" style=\"position:relative;\">Attempt 4: shareware tools<a href=\"#attempt-4-shareware-tools\" aria-label=\"attempt 4 shareware tools permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>Despite my priority of making the virtual drive first, I realized that first I need to backup very critical data to an external drive.</p>\n<h3 id=\"backup-data\" style=\"position:relative;\">Backup data<a href=\"#backup-data\" aria-label=\"backup data permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>How do you define what data is critical or not?</p>\n<p>You just imagine that in the following minute you are going to make actions that will erase all data without a chance to restore it.</p>\n<p>Seriously, imagine that it has happened.</p>\n<p>Then ask youself: how is it going to hurt if this folder will be erased? This folder? And this?</p>\n<p>This way you do backup. Windows and programs can be reinstalled, but your files - they made out of sweat, pain and love, it’s tough to create again and it hurts when you lose it.</p>\n<h3 id=\"backup-the-drive\" style=\"position:relative;\">Backup the drive<a href=\"#backup-the-drive\" aria-label=\"backup the drive permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>Boot from an another Windows drive while your system is connected as “external” drive.</p>\n<p>Create a backup file. I used <strong>AOMEI Backupper</strong> for this purpose.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; flex:1.4954128440366972;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/18ab0a859c0cdbc68db4190475fd1d0e/949c1/windows-clone-backup-software.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.87116564417178%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgME/9oADAMBAAIQAxAAAAHn2zt0QWQB/wD/xAAZEAEBAAMBAAAAAAAAAAAAAAABAAIQERL/2gAIAQEAAQUCx8SExd1//8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8BSf/EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAgEBPwEcn//EABcQAAMBAAAAAAAAAAAAAAAAAAAgIUH/2gAIAQEABj8C0i//xAAYEAEBAQEBAAAAAAAAAAAAAAAAATEhUf/aAAgBAQABPyGLfSR1bC6//9oADAMBAAIAAwAAABDsL//EABcRAAMBAAAAAAAAAAAAAAAAAAABIRH/2gAIAQMBAT8QZsZT/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARMf/aAAgBAgEBPxAnicv/xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhQTH/2gAIAQEAAT8QAbRuCC+QWuh1obmmOFcijEep/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Create a backup file\"\n        title=\"\"\n        src=\"/static/18ab0a859c0cdbc68db4190475fd1d0e/6aca1/windows-clone-backup-software.jpg\"\n        srcset=\"/static/18ab0a859c0cdbc68db4190475fd1d0e/d2f63/windows-clone-backup-software.jpg 163w,\n/static/18ab0a859c0cdbc68db4190475fd1d0e/c989d/windows-clone-backup-software.jpg 325w,\n/static/18ab0a859c0cdbc68db4190475fd1d0e/6aca1/windows-clone-backup-software.jpg 650w,\n/static/18ab0a859c0cdbc68db4190475fd1d0e/7c09c/windows-clone-backup-software.jpg 975w,\n/static/18ab0a859c0cdbc68db4190475fd1d0e/949c1/windows-clone-backup-software.jpg 1261w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Boot again from another Windows drive, but this time connect new drive as “external”.</p>\n<p>Restore backup.</p>\n<p>Extend system partition possibly saving the Rescue partition. I didn’t find how to “move” the partition in standard Disk Management from Microsoft, that’s why I used <strong>MiniTool Partition Wizard</strong> for this purpose.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; flex:1.8735632183908046;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8495e4c6780d27f48f6ce5b4aa166974/905a9/windows-clone-fix-partitions.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.37423312883436%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB1JeJVHFH/8QAGhAAAwEAAwAAAAAAAAAAAAAAAAEDAhETMf/aAAgBAQABBQLomKOEajPliNe//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8BiP/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/Aar/xAAZEAABBQAAAAAAAAAAAAAAAAAAASAhMTL/2gAIAQEABj8CyQhTP//EABoQAAMAAwEAAAAAAAAAAAAAAAABMRBhcYH/2gAIAQEAAT8h1yEr1ikcIJcP/9oADAMBAAIAAwAAABB43//EABYRAQEBAAAAAAAAAAAAAAAAAAARUf/aAAgBAwEBPxCMQ//EABgRAAMBAQAAAAAAAAAAAAAAAAABETFR/9oACAECAQE/EK6Jpp//xAAbEAEAAgMBAQAAAAAAAAAAAAABADEhUdFB8P/aAAgBAQABPxBIrxSvZ6Ya6QAFe3syuEStw/DbP//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Fix partitions\"\n        title=\"\"\n        src=\"/static/8495e4c6780d27f48f6ce5b4aa166974/6aca1/windows-clone-fix-partitions.jpg\"\n        srcset=\"/static/8495e4c6780d27f48f6ce5b4aa166974/d2f63/windows-clone-fix-partitions.jpg 163w,\n/static/8495e4c6780d27f48f6ce5b4aa166974/c989d/windows-clone-fix-partitions.jpg 325w,\n/static/8495e4c6780d27f48f6ce5b4aa166974/6aca1/windows-clone-fix-partitions.jpg 650w,\n/static/8495e4c6780d27f48f6ce5b4aa166974/7c09c/windows-clone-fix-partitions.jpg 975w,\n/static/8495e4c6780d27f48f6ce5b4aa166974/01ab0/windows-clone-fix-partitions.jpg 1300w,\n/static/8495e4c6780d27f48f6ce5b4aa166974/905a9/windows-clone-fix-partitions.jpg 1729w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"troubleshooting\" style=\"position:relative;\">Troubleshooting<a href=\"#troubleshooting\" aria-label=\"troubleshooting permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>If you found this article from a google search trying to fix a rare message on Blue Screen of death from Windows, then here are my few observations that can help.</p>\n<h3 id=\"a-required-device-isnt-connected-or-cant-be-accessed\" style=\"position:relative;\">A Required Device Isn't Connected or Can't Be Accessed<a href=\"#a-required-device-isnt-connected-or-cant-be-accessed\" aria-label=\"a required device isnt connected or cant be accessed permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>If you see this error then you should take a look on your EFI boot record.</p>\n<p><a href=\"http://woshub.com/how-to-repair-uefi-bootloader-in-windows-8/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Read more in this article</a>, where the author understands what applied commands are doing. Comparing to all other copywriters, that appear first in the search results, but have no idea of what they are recommending.</p>\n<h3 id=\"access-is-denied-bootrec-fixboot\" style=\"position:relative;\">Access is denied (bootrec /fixboot)<a href=\"#access-is-denied-bootrec-fixboot\" aria-label=\"access is denied bootrec fixboot permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>If you get \"Access is denied\" error while running bootrec /fixboot then you have something broken in C:\\windows. Like missing files, wrong permission.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"flex:1.7717391304347827;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9b8904c3a844dad6077fe8466abc5dce/0f98f/windows-clone-missing-folders.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.44171779141104%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB3RJJlYf/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREg/9oACAEBAAEFAsUrP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAQEAAwEAAAAAAAAAAAAAAAABETFBYf/aAAgBAQABPyGadRbWT2f/2gAMAwEAAgADAAAAEOf/AP/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/EFf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxBH/8QAHRABAAICAgMAAAAAAAAAAAAAAQARITFBkaHw8f/aAAgBAQABPxC2msQafvERWR6hgRhXd+I/BP/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Windows after diagnosing the filesystem removed many files\"\n        title=\"Working windows on the left, broken backup on the right. Program files (x86) is missing\"\n        src=\"/static/9b8904c3a844dad6077fe8466abc5dce/6aca1/windows-clone-missing-folders.jpg\"\n        srcset=\"/static/9b8904c3a844dad6077fe8466abc5dce/d2f63/windows-clone-missing-folders.jpg 163w,\n/static/9b8904c3a844dad6077fe8466abc5dce/c989d/windows-clone-missing-folders.jpg 325w,\n/static/9b8904c3a844dad6077fe8466abc5dce/6aca1/windows-clone-missing-folders.jpg 650w,\n/static/9b8904c3a844dad6077fe8466abc5dce/7c09c/windows-clone-missing-folders.jpg 975w,\n/static/9b8904c3a844dad6077fe8466abc5dce/01ab0/windows-clone-missing-folders.jpg 1300w,\n/static/9b8904c3a844dad6077fe8466abc5dce/0f98f/windows-clone-missing-folders.jpg 1920w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>Working windows on the left, broken backup on the right. Program files (x86) is missing</p></figcaption>\n  </figure></p>\n<h3 id=\"bcdboot-failed-to-validate-boot-manager-checksum\" style=\"position:relative;\">bcdboot failed to validate boot manager checksum<a href=\"#bcdboot-failed-to-validate-boot-manager-checksum\" aria-label=\"bcdboot failed to validate boot manager checksum permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h3>\n<p>If you are trying to format ESP partition</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">format N: /FS:FAT32</code></pre></div>\n<p>and recreate boot files with</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">bcdboot C:\\windows /s N: /f UEFI /v</code></pre></div>\n<p>and you get “bcdboot failed to validate boot manager checksum”</p>\n<p>then you have something broken in C:\\windows. Like missing files, wrong permission.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"flex:1.7717391304347827;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2140c5ca46d3707f453c839710d0da1f/0f98f/windows-clone-empty-files.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.44171779141104%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB3RYRysP/xAAXEAEBAQEAAAAAAAAAAAAAAAAAEQEQ/9oACAEBAAEFAu6qv//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAMAAwAAAAAAAAAAAAAAAAABERAhQf/aAAgBAQABPyFHcNoqFH//2gAMAwEAAgADAAAAED//AP/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/EFf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxBH/8QAHBAAAgICAwAAAAAAAAAAAAAAABEBIUFRYZGh/9oACAEBAAE/EGTia0U3Y3kktmSEL2cvh//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Copied empty files\"\n        title=\"Working windows on the left, broken backup on the right. Many files just empty\"\n        src=\"/static/2140c5ca46d3707f453c839710d0da1f/6aca1/windows-clone-empty-files.jpg\"\n        srcset=\"/static/2140c5ca46d3707f453c839710d0da1f/d2f63/windows-clone-empty-files.jpg 163w,\n/static/2140c5ca46d3707f453c839710d0da1f/c989d/windows-clone-empty-files.jpg 325w,\n/static/2140c5ca46d3707f453c839710d0da1f/6aca1/windows-clone-empty-files.jpg 650w,\n/static/2140c5ca46d3707f453c839710d0da1f/7c09c/windows-clone-empty-files.jpg 975w,\n/static/2140c5ca46d3707f453c839710d0da1f/01ab0/windows-clone-empty-files.jpg 1300w,\n/static/2140c5ca46d3707f453c839710d0da1f/0f98f/windows-clone-empty-files.jpg 1920w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>Working windows on the left, broken backup on the right. Many files just empty</p></figcaption>\n  </figure></p>\n<p>BCD file itself can be reviewed and possibly fixed if you take a look in <a href=\"https://www.boyans.net/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">free visual editor</a>, know <a href=\"http://woshub.com/how-to-rebuild-bcd-file-in-windows-10/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">basic commands</a>, aware of <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/adding-boot-entries\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">Windows boot manager settings</a>, and maybe even know <a href=\"https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/bcd-system-store-settings-for-uefi?view=windows-11\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">more commands</a>. In the end bcdedit has <a href=\"https://www.itechguides.com/windows-boot-manager-how-to-edit-bootmgr-and-fix-boot-errors-in-windows-10/\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">pages of help information</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; flex:1.5377358490566038;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/51eb09e05c9f7ed827961e64c9caf056/7c2eb/windows-clone-visual-bcd.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.03067484662577%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdmqYig//8QAFxABAQEBAAAAAAAAAAAAAAAAABEBEP/aAAgBAQABBQJExe//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAcEAABBAMBAAAAAAAAAAAAAAAAAREhMRBhcYH/2gAIAQEAAT8hWvRJUaDgeHx//9oADAMBAAIAAwAAABDTD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQEBAQADAAAAAAAAAAAAAAEAESExUaH/2gAIAQEAAT8Q1oA4iJ08fJ9WAGk8OJv/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Visual BCD\"\n        title=\"\"\n        src=\"/static/51eb09e05c9f7ed827961e64c9caf056/6aca1/windows-clone-visual-bcd.jpg\"\n        srcset=\"/static/51eb09e05c9f7ed827961e64c9caf056/d2f63/windows-clone-visual-bcd.jpg 163w,\n/static/51eb09e05c9f7ed827961e64c9caf056/c989d/windows-clone-visual-bcd.jpg 325w,\n/static/51eb09e05c9f7ed827961e64c9caf056/6aca1/windows-clone-visual-bcd.jpg 650w,\n/static/51eb09e05c9f7ed827961e64c9caf056/7c09c/windows-clone-visual-bcd.jpg 975w,\n/static/51eb09e05c9f7ed827961e64c9caf056/7c2eb/windows-clone-visual-bcd.jpg 1173w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Or it can <a href=\"https://answers.microsoft.com/en-us/windows/forum/all/how-do-you-recover-from-missing-bootmgr-following/b02a0743-1dd5-4b15-a277-74b4f4f2446d\" target=\"_blank\" rel=\"external nofollow noopener noreferrer\">magically fix itself</a></p>\n<h2 id=\"conclusion\" style=\"position:relative;\">Conclusion<a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"with-anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\">\n                <path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3\n                3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3\n                  9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64\n                  1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\">\n                </path>\n                </svg></a></h2>\n<p>Notwithstanding that I tried to avoid any extra Windows software installed, I ended up trying many tools, but has chosen to keep 2 specific tools to repeat the similar procedure in the future without hassle like during this week.</p>\n<p>I will keep <strong>MiniTool Partition Wizard</strong> for shaping partitions to my preferences: moving partitions, and to run filesystem check.</p>\n<p>Also <strong>AOMEI Backupper</strong> for making and restoring backups. It uses it’s proprietary not common format, so I depend now on this software. But I assume they use some simple format like dd and with encryption on top and with handy metadata. Some info about their format would be helpful. Might be an interesting task to reverse engineer it and to find out why their software worked for me.</p>\n<p>Optionally I install <strong>Samsung Magician</strong> for displaying beautiful pulsing health status of the drive. Of course it works only with Samsung, but pulsing animation can be scraped from the install folder for my hobby projects.</p>\n<p>Linux tools for NTFS file system - never again.</p>","excerpt":"What do you need to know when you clone Windows 10 from one drive to another or How I spent one week without a computer trying to upgrade…","tableOfContents":"<ul>\n<li>\n<p><a href=\"#attempt-1-rsync\">Attempt 1: rsync</a></p>\n<ul>\n<li><a href=\"#plan\">Plan</a></li>\n<li><a href=\"#pitfalls\">Pitfalls</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#attempt-2-dd\">Attempt 2: dd</a></p>\n<ul>\n<li><a href=\"#benchmark-ssd-readwrite-speed-with-dd\">Benchmark SSD read/write speed with dd</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#attempt-3-vhd\">Attempt 3: VHD</a></p>\n</li>\n<li>\n<p><a href=\"#attempt-4-shareware-tools\">Attempt 4: shareware tools</a></p>\n<ul>\n<li><a href=\"#backup-data\">Backup data</a></li>\n<li><a href=\"#backup-the-drive\">Backup the drive</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#troubleshooting\">Troubleshooting</a></p>\n<ul>\n<li><a href=\"#a-required-device-isnt-connected-or-cant-be-accessed\">A Required Device Isn't Connected or Can't Be Accessed</a></li>\n<li><a href=\"#access-is-denied-bootrec-fixboot\">Access is denied (bootrec /fixboot)</a></li>\n<li><a href=\"#bcdboot-failed-to-validate-boot-manager-checksum\">bcdboot failed to validate boot manager checksum</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#conclusion\">Conclusion</a></p>\n</li>\n</ul>","fields":{"socialcard":"gatsby-plugin-social-card/6a68ad41-27f7-5943-b153-e860daaba217.jpg"},"frontmatter":{"date":"May 23, 2022","published":"June 10, 2022","lastModified":"August 20, 2022","title":"Windows clone","subtitle":null,"section":null,"draft":null,"developing":null,"buttonText":null,"buttonLink":null,"secondButtonText":null,"secondButtonLink":null,"featuredImage":{"publicURL":"/static/1aaa2714f8bf0d83ad9d8a95c47ee4e9/windows-clone-feature.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#d8c8a8","images":{"fallback":{"src":"/static/1aaa2714f8bf0d83ad9d8a95c47ee4e9/fff49/windows-clone-feature.jpg","srcSet":"/static/1aaa2714f8bf0d83ad9d8a95c47ee4e9/60d05/windows-clone-feature.jpg 576w,\n/static/1aaa2714f8bf0d83ad9d8a95c47ee4e9/042f4/windows-clone-feature.jpg 768w,\n/static/1aaa2714f8bf0d83ad9d8a95c47ee4e9/fff49/windows-clone-feature.jpg 922w","sizes":"100vw"},"sources":[{"srcSet":"/static/1aaa2714f8bf0d83ad9d8a95c47ee4e9/104bf/windows-clone-feature.webp 576w,\n/static/1aaa2714f8bf0d83ad9d8a95c47ee4e9/ed3a4/windows-clone-feature.webp 768w,\n/static/1aaa2714f8bf0d83ad9d8a95c47ee4e9/398ec/windows-clone-feature.webp 922w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5119305856832972}}}}}},"pageContext":{"showLikes":true,"absolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/windows-clone.md","url":"/blog/windows-clone","next":{"excerpt":"This is typical me. It’s happening so slow that I don’t know when the milestone does occur. If it had happened the next day when I…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/100-followers-on-twitter.md","frontmatter":{"title":"Epistle to my followers","date":"2022-06-01T00:00:00.000Z","topic":null,"article":null},"id":"52cffda3-9ca8-5492-8468-c8a13c34fead"},"previous":{"excerpt":"Today my niche site is exactly 2 years old and just surpassed 112 pagewievs/month 📈\nAll this time, I’ve been learning and iterating on how…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/seo-tips-and-tricks.md","frontmatter":{"title":"SEO tips and tricks","date":"2022-05-08T00:00:00.000Z","topic":null,"article":null},"id":"29812e77-f2f2-5f3d-bcf8-cbf83961f1df"},"recentArticles":[{"excerpt":"To read AI hype is over? (post from 2023) - L’IA n’est-elle qu’un mythe qui s’essoufflera ? About Google alternative services -  Comment j…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/learning-french.md","frontmatter":{"title":"How I am learning French","date":"2025-07-12T00:00:00.000Z","topic":null,"article":null},"id":"de46ffde-c202-594f-b222-f5f4a548fbe4"},{"excerpt":"I think I like having a dialogue with someone who knows about the topic, even with students who just obtained knowledge from canonical…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/lizards-and-continuous-space.md","frontmatter":{"title":"Lizards and Continuous space","date":"2025-06-23T00:00:00.000Z","topic":null,"article":null},"id":"6ee1f95a-2c05-5950-8a0d-20ff4d937fb1"},{"excerpt":"Yes, developers add new features, refactor other parts to get rid of technical debt. This often changes API, which usually triggers…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/new-ui-and-conspiracy-in-it-industry.md","frontmatter":{"title":"New UI","date":"2025-06-21T00:00:00.000Z","topic":null,"article":null},"id":"fe2e710c-0afa-5b11-8a7d-1dc46d02f0f9"},{"excerpt":"Now when I almost finished with the titanic competition (I didn’t reach 90% accuracy as I planned, although I doubt it’s possible), it’s…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/regulus.md","frontmatter":{"title":"Regulus","date":"2025-05-13T00:00:00.000Z","topic":null,"article":null},"id":"cf23a6fc-e0e2-571b-9dbf-5030b3af25dd"},{"excerpt":"When I found out there was a popular platform where people share open source projects, I imagined GitHub differently. I thought I could find…","fileAbsolutePath":"/home/runner/work/mikolasan.github.io/mikolasan.github.io/src/markdown/blog/how-github-should-work.md","frontmatter":{"title":"How GitHub should work","date":"2025-04-03T00:00:00.000Z","topic":null,"article":null},"id":"63562cc8-f132-5cbc-a444-5639c4a78d98"}]}},"staticQueryHashes":["2961657013","447685113"],"slicesMap":{}}